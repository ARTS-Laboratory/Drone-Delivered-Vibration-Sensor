clc
clear all
close all

%% Contruct initial TF
n=[1,2.455603685064564e+03,4.564068882670976e+04];
d=[1.330373311408007,2.313480790421754e+03,4.249729900997524e+04];
sys = tf(n,d)
bode(sys)

%% Inverse Laplace to time domain TF
syms  s
F = ((1*s^2+2.455603685064564e+03*s+4.564068882670976e+04)/(1.330373311408007*s^2+2.313480790421754e+03*s+4.249729900997524e+04))
fT=ilaplace(F)
% FF=laplace(fT)

%% Construct Input data
Fs = 100; %Hz
Ts = 1/Fs;
TestTime=40; %seconds
t = (0:Ts:TestTime);

WhiteNoise=0;
for Freq = 0:.05:21
   WhiteNoise=WhiteNoise+sin(Freq*2*pi*t);
end

%% Normalize Input
Min = min(WhiteNoise);
Max = max(WhiteNoise);
WhiteNoiseNorm=2*(WhiteNoise-Min)/(Max-Min)-1;
Data=[WhiteNoiseNorm];

Noise=randn(1,length(t));
RandomWhiteNoise=Noise+WhiteNoise;

Min = min(RandomWhiteNoise);
Max = max(RandomWhiteNoise);
RandomWhiteNoiseNorm=2*(RandomWhiteNoise-Min)/(Max-Min)-1;

figure(1)
plot(t,WhiteNoiseNorm);
title('Reference');
figure(2)
plot(t,RandomWhiteNoiseNorm);
title('Noise injected');


%% Feed Data intro Transfer function
u=WhiteNoiseNorm;
t=t;

PostSDomain=lsim(sys,u,t);
figure(3)
plot(t,PostSDomain);
TD=0;


%(4503599627370496*dirac(t))/5991468749520753 + (19337022469200708578664229650509824*exp(-(5209495612836106240*t)/5991468749520753)*(cosh((128*1586433863724969558803290237371946^(1/2)*t)/5991468749520753) - (3006646360014146003955148013417316042154159258175*1586433863724969558803290237371946^(1/2)*sinh((128*1586433863724969558803290237371946^(1/2)*t)/5991468749520753))/119831669018557153440833128536286505320168603563742583021003183584))/35897697776483775652167177687009;

TD=0;
TD=(4503599627370496*dirac(t))/5991468749520753 + (19337022469200708578664229650509824*exp(-(5209495612836106240*t)/5991468749520753).*(cosh((128*1586433863724969558803290237371946^(1/2)*t)/5991468749520753) - (3006646360014146003955148013417316042154159258175*1586433863724969558803290237371946^(1/2)*sinh((128*1586433863724969558803290237371946^(1/2)*t)/5991468749520753))/119831669018557153440833128536286505320168603563742583021003183584))/35897697776483775652167177687009

figure(4)
plot(t,TD);





